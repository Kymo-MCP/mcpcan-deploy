apiVersion: v1
kind: ConfigMap
metadata:
  name: helm-cmp
data:
  repositories.yaml: |
    repositories:
      - name: bitnami
        url: https://charts.bitnami.com/bitnami
        description: "Bitnami Helm Charts"
      - name: ingress-nginx
        url: https://kubernetes.github.io/ingress-nginx
        description: "Ingress NGINX Controller"
      - name: jetstack
        url: https://charts.jetstack.io
        description: "Jetstack Helm Charts (cert-manager)"
      - name: prometheus-community
        url: https://prometheus-community.github.io/helm-charts
        description: "Prometheus Community Charts"
      - name: grafana
        url: https://grafana.github.io/helm-charts
        description: "Grafana Helm Charts"
      - name: elastic
        url: https://helm.elastic.co
        description: "Elastic Helm Charts"
      - name: hashicorp
        url: https://helm.releases.hashicorp.com
        description: "HashiCorp Helm Charts"
      - name: redis
        url: https://charts.bitnami.com/bitnami
        description: "Redis Helm Charts"
      - name: mysql
        url: https://charts.bitnami.com/bitnami
        description: "MySQL Helm Charts"
      - name: postgresql
        url: https://charts.bitnami.com/bitnami
        description: "PostgreSQL Helm Charts"
      - name: mongodb
        url: https://charts.bitnami.com/bitnami
        description: "MongoDB Helm Charts"
---
apiVersion: batch/v1
kind: Job
metadata:
  name: helm-job
spec:
  template:
    spec:
      containers:
      - name: helm-job
        image: alpine/helm:latest
        command:
        - /bin/sh
        - -c
        - |
          helm repo add bitnami https://charts.bitnami.com/bitnami
          helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
          helm repo add jetstack https://charts.jetstack.io
          helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
          helm repo add grafana https://grafana.github.io/helm-charts
          helm repo add elastic https://helm.elastic.co
          helm repo add hashicorp https://helm.releases.hashicorp.com
          helm repo update
          echo "Helm repositories setup completed"
        volumeMounts:
        - name: helm-config
          mountPath: /root/.helm
      volumes:
      - name: helm-config
        configMap:
          name: helm-cmp
      restartPolicy: OnFailure
  backoffLimit: 3